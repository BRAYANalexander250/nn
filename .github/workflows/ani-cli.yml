on:
  push:
    paths: 
      - "**ani-cli"
  pull_request:
    paths: 
      - "**ani-cli"

name: 'ani-cli checks'

jobs:
  sh-checker:
    name: Shellcheck & Shfmt
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Run the sh-checker
      uses: luizm/action-sh-checker@master
      env:
        SHELLCHECK_OPTS: -s sh -o all -e 2250
        SHFMT_OPTS: -i 4 -ci -d

  dead-links:
    name: Dead Link Checker
    runs-on: ubuntu-latest
    steps:
    - name: Run DeadFinder
      uses: hahwul/deadfinder@1.2.4
      id: broken-link
      with:
        command: file
        target: "**.md"
    - name: Output Handling
      run: echo '${{ steps.broken-link.outputs.output }}'
      
  check-exec:
    name: Check for executable bit
    runs-on: ubuntu-latest
    steps:
    - name: test exec bit
      run: |
        test -x "./ani-cli"
        ls

  version-bump:
    name: Check for version bump
    runs-on: ubuntu-latest
    steps:
    - name: test exec bit
      run: git diff origin/master | grep version_number
